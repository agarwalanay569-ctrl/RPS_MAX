<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>RPS MAX</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box;font-family:system-ui,sans-serif}
body{
  margin:0;min-height:100vh;
  background:radial-gradient(circle at top,#3b0066,#000);
  display:flex;justify-content:center;align-items:center;
  color:#fff
}
.app{
  width:420px;max-width:95%;
  background:rgba(255,255,255,.08);
  border-radius:24px;
  padding:25px;
  box-shadow:0 0 50px #a100ff;
  text-align:center
}
h1{margin:0;font-size:32px}
.subtitle{opacity:.75;margin-bottom:10px}

input{
  width:100%;padding:10px;
  border-radius:10px;border:none;
  margin-bottom:10px;font-size:16px
}
button{
  cursor:pointer;border:none;
  border-radius:12px;
  padding:12px;
  font-size:18px;
  background:linear-gradient(45deg,#ff0080,#8000ff);
  color:#fff
}
button:hover{filter:brightness(1.2)}

.top{
  display:flex;justify-content:space-between;
  margin:10px 0;font-size:14px
}

.panel{
  background:rgba(0,0,0,.3);
  border-radius:12px;
  padding:10px;
  margin:10px 0
}

.score{
  display:flex;justify-content:space-between;
  margin:10px 0;font-size:18px
}

.choices{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:12px;margin:15px 0
}
.choice{
  font-size:32px;
  background:rgba(255,255,255,.15)
}
.choice:hover{
  transform:scale(1.15);
  box-shadow:0 0 20px #ff00ff
}

.result{min-height:40px;font-size:18px}

.footer{margin-top:10px;font-size:12px;opacity:.7}
</style>
</head>

<body>
<div class="app">

<h1>RPS MAX</h1>
<div class="subtitle">Compete. Win. Climb.</div>

<div id="login">
  <input id="username" placeholder="Username">
  <button onclick="start()">Start</button>
</div>

<div id="game" style="display:none">
  <div class="top">
    <div>Player: <b id="name"></b></div>
    <div>üîä <input type="checkbox" id="sound" checked></div>
  </div>

  <div class="panel">
    Wins: <span id="wins">0</span> |
    Losses: <span id="losses">0</span> |
    Win %: <span id="winrate">0</span>%
  </div>

  <div class="score">
    <div>You: <span id="pScore">0</span></div>
    <div>AI: <span id="aScore">0</span></div>
  </div>

  <div class="choices">
    <button class="choice" onclick="play('rock')">‚úä</button>
    <button class="choice" onclick="play('paper')">‚úã</button>
    <button class="choice" onclick="play('scissors')">‚úåÔ∏è</button>
    <button class="choice" onclick="play('lizard')">ü¶é</button>
    <button class="choice" onclick="play('spock')">üññ</button>
  </div>

  <div class="result" id="result">Make your move.</div>
  <button onclick="resetMatch()">Reset Match</button>
</div>

<div class="footer">
Keyboard: R P S L K<br>
¬© RPS MAX
</div>

</div>

<script>
const rules={
 rock:["scissors","lizard"],
 paper:["rock","spock"],
 scissors:["paper","lizard"],
 lizard:["spock","paper"],
 spock:["scissors","rock"]
};

let user=localStorage.user||"";
let stats=JSON.parse(localStorage.stats||
 '{"wins":0,"losses":0,"games":0}');
let pScore=0,aScore=0;
let history=[];

if(user)start(true);

function start(auto=false){
 const input=document.getElementById("username");
 if(!auto){
  if(!input.value.trim())return;
  user=input.value.trim();
  localStorage.user=user;
 }
 document.getElementById("login").style.display="none";
 document.getElementById("game").style.display="block";
 document.getElementById("name").textContent=user;
 updateStats();
}

function rand(){
 const k=Object.keys(rules);
 return k[Math.random()*k.length|0];
}

// ‚úÖ FAIR AI FIX
function aiMove(){
  if(Math.random()<0.6||history.length<2){
    return rand();
  }
  const last=history.at(-1);
  const counters=Object.keys(rules)
    .filter(m=>rules[m].includes(last));
  return counters.length
    ? counters[Math.floor(Math.random()*counters.length)]
    : rand();
}

function play(move){
 history.push(move);
 const ai=aiMove();

 if(move===ai){
  result("üòê Draw! Both chose "+move);
  return;
 }

 if(rules[move].includes(ai)){
  pScore++;stats.wins++;
  result("üî• You win! "+move+" beats "+ai);
 }else{
  aScore++;stats.losses++;
  result("üíÄ AI wins! "+ai+" beats "+move);
 }

 stats.games++;
 save();update();
}

function update(){
 document.getElementById("pScore").textContent=pScore;
 document.getElementById("aScore").textContent=aScore;
 updateStats();
}

function updateStats(){
 document.getElementById("wins").textContent=stats.wins;
 document.getElementById("losses").textContent=stats.losses;
 document.getElementById("winrate").textContent=
  stats.games?Math.round(stats.wins/stats.games*100):0;
}

function save(){
 localStorage.stats=JSON.stringify(stats);
}

function resetMatch(){
 pScore=0;aScore=0;history=[];
 update();result("Match reset. Go again.");
}

function result(t){
 document.getElementById("result").textContent=t;
}

document.addEventListener("keydown",e=>{
 const m={r:"rock",p:"paper",s:"scissors",l:"lizard",k:"spock"};
 if(m[e.key])play(m[e.key]);
});
</script>
</body>
</html>
